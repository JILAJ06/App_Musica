<ng-container *ngIf="currentSong$ | async as currentSong">

  <div class="main-container">
    <div class="song-artwork-container">
      <img [src]="currentSong.artwork" [alt]="currentSong.title" class="song-artwork">
    </div>

    <div class="playlist-container">
      <div class="playlist-header">
        <h2>Siguiente en la Fila</h2>
      </div>

      <div class="now-playing">
        <p class="list-subtitle">Reproduciendo ahora</p>
        <div class="playlist-item active">
          <span class="material-symbols-outlined sound-wave">bar_chart</span>
          <img [src]="currentSong.artwork" [alt]="currentSong.title">
          <div class="song-details">
            <p class="song-title">{{ currentSong.title }}</p>
            <p class="artist-name">{{ currentSong.artist }}</p>
          </div>
        </div>
      </div>

      <div class="up-next">
        <ng-container *ngFor="let song of (songs$ | async)">
          <div class="playlist-item" *ngIf="song.url !== currentSong.url" (click)="playSong(song)">
            <span class="material-symbols-outlined play-icon">play_arrow</span>
            <img [src]="song.artwork" [alt]="song.title">
            <div class="song-details">
              <p class="song-title">{{ song.title }}</p>
              <p class="artist-name">{{ song.artist }}</p>
            </div>
          </div>
        </ng-container>
      </div>
    </div>
  </div>

  <div class="player-bar">
    <div class="player-song-info">
      <img [src]="currentSong.artwork" [alt]="currentSong.title">
      <div class="song-details">
        <p class="song-title">{{ currentSong.title }}</p>
        <p class="artist-name">{{ currentSong.artist }}</p>
      </div>
    </div>

    <div class="player-controls">
      <div class="control-buttons">
        <button class="control-button"><span class="material-symbols-outlined">shuffle</span></button>
        <button class="control-button"><span class="material-symbols-outlined">skip_previous</span></button>
        <button class="control-button play-button" (click)="togglePlayPause()">
          <span class="material-symbols-outlined">{{ (isPlaying$ | async) ? 'pause' : 'play_arrow' }}</span>
        </button>
        <button class="control-button"><span class="material-symbols-outlined">skip_next</span></button>
        <button class="control-button"><span class="material-symbols-outlined">repeat</span></button>
      </div>
      <div class="progress-bar-container">
        <span class="time">{{ formatTime(currentTime$ | async) }}</span>
        <div class="progress-bar" (click)="seekTo($event)">
          <div class="progress" [style.width.%]="((currentTime$ | async) ?? 0) / ((duration$ | async) || 1) * 100"></div>
        </div>
        <span class="time">{{ formatTime(duration$ | async) }}</span>
      </div>
    </div>

    <div class="player-options">
      <span class="material-symbols-outlined">playlist_play</span>
      <span class="material-symbols-outlined">volume_up</span>
      <div class="volume-bar">
        <div class="volume-progress"></div>
      </div>
    </div>
  </div>

</ng-container>